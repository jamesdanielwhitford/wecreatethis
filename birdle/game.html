<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#333">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Game - Birdle</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Sticky Navbar -->
  <nav class="game-navbar">
    <a href="games" class="back-btn">&larr; Back</a>
    <button id="menu-btn" class="menu-btn">⋮</button>
    <div id="menu-dropdown" class="menu-dropdown" style="display:none;">
      <button id="menu-share-score">Share Score</button>
      <button id="menu-share-game">Share Game</button>
      <button id="menu-change-dates">Change Dates</button>
      <button id="menu-delete-game" class="danger">Delete Game</button>
    </div>
  </nav>

  <!-- Game Header -->
  <div class="game-header">
    <h1 id="game-title">Loading...</h1>
    <a id="game-location" class="location-link" href="#" target="_blank"></a>
    <p id="game-dates" class="game-dates"></p>
  </div>

  <!-- Game Ended Banner -->
  <div id="game-ended-banner" class="ended-banner" style="display:none;">
    <p>This game has ended. Use the menu to change dates.</p>
  </div>

  <!-- Score Summary -->
  <div class="score-summary">
    <div class="score-item">
      <span id="total-found" class="score-number">0</span>
      <span class="score-label">Found</span>
    </div>
    <div class="score-item common">
      <span id="common-found" class="score-number">0</span>
      <span class="score-label">Common</span>
    </div>
    <div class="score-item rare">
      <span id="rare-found" class="score-number">0</span>
      <span class="score-label">Rare</span>
    </div>
    <div class="score-item ultra">
      <span id="ultra-found" class="score-number">0</span>
      <span class="score-label">Ultra</span>
    </div>
  </div>

  <!-- Search within game -->
  <div class="search-bar">
    <input type="text" id="game-bird-search" placeholder="Search birds in this game...">
  </div>

  <!-- Loading State -->
  <div id="game-loading" class="loading">Loading birds for this area...</div>

  <!-- Bird Lists -->
  <div id="bird-sections" style="display:none;">
    <div class="bird-section">
      <h3 class="section-title common" data-section="common">
        <span class="toggle-arrow">▼</span>
        Common <span id="common-count"></span>
      </h3>
      <ul id="common-birds" class="game-bird-list"></ul>
    </div>

    <div class="bird-section">
      <h3 class="section-title rare" data-section="rare">
        <span class="toggle-arrow">▼</span>
        Rare <span id="rare-count"></span>
      </h3>
      <ul id="rare-birds" class="game-bird-list"></ul>
    </div>

    <div class="bird-section">
      <h3 class="section-title ultra" data-section="ultra">
        <span class="toggle-arrow">▼</span>
        Ultra <span id="ultra-count"></span>
      </h3>
      <ul id="ultra-birds" class="game-bird-list"></ul>
    </div>
  </div>

  <!-- Bird Action Modal -->
  <div id="bird-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3 id="modal-bird-name"></h3>
      <p id="modal-bird-rarity" class="modal-rarity"></p>

      <!-- Sightings for this game -->
      <div class="modal-sightings">
        <h4>Sightings in this game</h4>
        <div id="modal-sightings-list" class="sightings-list"></div>
      </div>

      <button id="modal-add-sighting-btn" class="modal-btn seen">+ Add Sighting</button>
      <a id="modal-google-link" class="modal-btn google" href="#" target="_blank">Search Google</a>
      <button id="modal-cancel-btn" class="modal-btn cancel">Close</button>
    </div>
  </div>

  <!-- Add Sighting Modal (for game) -->
  <div id="game-sighting-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3>Log Sighting</h3>
      <p class="modal-subtitle" id="game-sighting-bird-name"></p>
      <div class="form-group">
        <label for="game-sighting-date">Date</label>
        <input type="date" id="game-sighting-date">
      </div>
      <div class="form-group">
        <label for="game-sighting-notes">Notes (optional)</label>
        <textarea id="game-sighting-notes" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"></textarea>
      </div>
      <p class="hint">Location: <span id="game-sighting-region"></span></p>
      <div class="modal-actions">
        <button id="game-sighting-cancel-btn" class="modal-btn cancel">Cancel</button>
        <button id="game-sighting-save-btn" class="modal-btn seen">Save</button>
      </div>
    </div>
  </div>

  <!-- Share Score Modal -->
  <div id="share-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3>Share Score</h3>

      <div class="share-options">
        <label class="checkbox-label">
          <input type="checkbox" id="share-total" checked> Total birds found
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="share-rarity" checked> Birds by rarity
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="share-list" checked> List of birds
        </label>
      </div>

      <div class="share-timeframe">
        <label>Timeframe:</label>
        <select id="share-timeframe">
          <option value="all">All time</option>
          <option value="today">Today</option>
          <option value="week">This week</option>
          <option value="custom">Custom dates</option>
        </select>
      </div>

      <div id="custom-dates" style="display:none;">
        <input type="date" id="share-from-date">
        <input type="date" id="share-to-date">
      </div>

      <button id="do-share-btn" class="modal-btn seen">Share</button>
      <button id="share-cancel-btn" class="modal-btn cancel">Cancel</button>
    </div>
  </div>

  <!-- Change Dates Modal -->
  <div id="dates-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3>Change Dates</h3>
      <div class="form-group">
        <label>Start Date</label>
        <input type="date" id="edit-start-date">
      </div>
      <div class="form-group">
        <label>End Date</label>
        <div class="input-row">
          <input type="date" id="edit-end-date">
          <button id="edit-forever-btn">Forever</button>
        </div>
      </div>
      <button id="do-save-dates-btn" class="modal-btn seen">Save</button>
      <button id="dates-cancel-btn" class="modal-btn cancel">Cancel</button>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="delete-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3>Delete Game?</h3>
      <p>This will permanently delete this game and all progress.</p>
      <button id="do-delete-btn" class="modal-btn danger">Delete</button>
      <button id="delete-cancel-btn" class="modal-btn cancel">Cancel</button>
    </div>
  </div>

  <script src="db.js?v=48"></script>
  <script src="ebird.js?v=48"></script>
  <script src="app.js?v=48"></script>
</body>
</html>
